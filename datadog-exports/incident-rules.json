{
  "description": "V-Commerce Datadog Incident Management Rules - Active Incident Rules",
  "version": "2.0.0",
  "last_updated": "2024-12-30",
  "incident_rules": [
    {
      "name": "[V-Commerce] Prompt Injection Security Incident",
      "enabled": true,
      "monitor_id": 17348390,
      "monitor_name": "[V-Commerce] LLM Prompt Injection / Adversarial Input Detection",
      "description": "Automatically creates SEV-1 incident when prompt injection attack is detected from a session",
      "trigger": {
        "type": "monitor",
        "monitor_tags": [
          "detection_rule:injection",
          "incident:auto-create"
        ],
        "notification_handle": "@incident-prompt-injection",
        "condition": "alert"
      },
      "incident_settings": {
        "title_template": "ðŸ”´ Security Incident: Prompt Injection Attack - Session {{session_id.name}}",
        "severity": "SEV-1",
        "state": "active",
        "commander": "@security-oncall",
        "notifications": [
          {
            "type": "slack",
            "channel": "#security-alerts"
          },
          {
            "type": "pagerduty",
            "service": "security-oncall"
          }
        ],
        "incident_summary": "## ðŸ”´ Security Incident: Prompt Injection Attack on Chatbot Service\n\n**Incident Type:** LLM Prompt Injection Attack\n**Severity:** SEV-1 (Critical)\n**Service Affected:** chatbotservice\n**Environment:** hackathon\n\n### Summary\nThe Chatbot Service detected a prompt injection attempt from session `{{session_id.name}}`. The attacker attempted to manipulate the LLM through crafted prompts designed to bypass safety guardrails or extract sensitive information.\n\n### Attack Details\n- **Attacker Session ID:** `{{session_id.name}}`\n- **Injection Score:** {{value}} (threshold: 0.7)\n- **Attack Confidence:** High\n- **Detection Time:** {{last_triggered_at}}\n\n### Attack Vector Analysis\n- System prompt extraction attempts\n- Jailbreak/safety bypass techniques\n- Instruction override injection\n- Potential data exfiltration prompts\n\n### Impact\n- LLM security controls detected and flagged the attack\n- Potential exposure of system prompts if attack succeeded\n- Risk of content safety filter bypass\n- Session activity logged for forensic analysis\n\n### Actions Taken\n1. Attack attempt flagged by injection detection system\n2. Security team notified via incident\n3. Session activity preserved for forensics\n4. Attacker session ID recorded: `{{session_id.name}}`\n\n### Next Steps\n1. Review full prompt content in APM traces\n2. Consider blocking session `{{session_id.name}}`\n3. Check for similar patterns from other sessions\n4. Update prompt blocklist if new attack pattern identified\n5. Review and strengthen input validation\n\n### Contacts\n- **Security Team:** @security-team\n- **LLM Service Owner:** @chatbot-service-owner",
        "fields": {
          "attacker_session_id": {
            "type": "text",
            "value": "{{session_id.name}}"
          },
          "injection_score": {
            "type": "number",
            "value": "{{value}}"
          },
          "attack_type": {
            "type": "dropdown",
            "options": [
              "prompt_injection",
              "jailbreak",
              "system_prompt_extraction",
              "data_exfiltration"
            ],
            "value": "prompt_injection"
          },
          "root_cause": {
            "type": "text",
            "value": "Prompt injection attack detected from session {{session_id.name}}"
          },
          "customer_impact": {
            "type": "text",
            "value": "Potential exposure of system prompts, risk of safety bypass"
          },
          "services_affected": {
            "type": "multiselect",
            "value": [
              "chatbotservice"
            ]
          }
        },
        "runbook_link": "https://github.com/mvp-ing/v-commerce-studio/blob/main/docs/RUNBOOKS.md#prompt-injection-detection"
      }
    },
    {
      "name": "[V-Commerce] Multimodal Security Attack Incident",
      "enabled": true,
      "monitor_id": 17348195,
      "monitor_name": "[V-Commerce] Multimodal Security Attack Detection - Try-On Service",
      "description": "Automatically creates SEV-2 incident when image-based security attacks are detected on Try-On service",
      "trigger": {
        "type": "monitor",
        "monitor_tags": [
          "detection_rule:multimodal_security",
          "incident:auto-create"
        ],
        "notification_handle": "@incident-multimodal",
        "condition": "alert"
      },
      "incident_settings": {
        "title_template": "ðŸ”´ Security Incident: Multimodal Attack on Try-On Service - User {{user_id.name}}",
        "severity": "SEV-2",
        "state": "active",
        "commander": "@security-oncall",
        "notifications": [
          {
            "type": "slack",
            "channel": "#security-alerts"
          },
          {
            "type": "pagerduty",
            "service": "security-oncall"
          }
        ],
        "incident_summary": "## ðŸ”´ Security Incident: Multimodal Attack on Try-On Service\n\n**Incident Type:** Image-Based Security Attack\n**Severity:** SEV-2 (High)\n**Service Affected:** tryonservice\n**Environment:** hackathon\n\n### Summary\nThe Try-On Service detected repeated malicious image uploads from user `{{user_id.name}}`. The attacker submitted decompression bombs and/or invalid image files designed to exhaust server memory or exploit image processing vulnerabilities.\n\n### Attack Details\n- **Attacker User ID:** `{{user_id.name}}`\n- **Attack Count:** {{value}} attempts in 5 minutes\n- **Attack Types:** Decompression bombs, malformed/corrupted images\n- **Detection Time:** {{last_triggered_at}}\n\n### Impact\n- Try-On service blocked the malicious requests\n- Potential memory pressure on service pods\n- User experience may be affected for legitimate users\n\n### Actions Taken\n1. Attack attempts automatically blocked by security controls\n2. Security team notified via this incident\n3. User activity logged for forensic analysis\n\n### Next Steps\n1. Review APM traces for user `{{user_id.name}}`\n2. Consider blocking this user_id at the application level\n3. Monitor service health for any residual effects\n4. Update security rules if new attack patterns identified\n\n### Contacts\n- **Security Team:** @security-team\n- **Service Owner:** @tryon-service-owner",
        "fields": {
          "attacker_user_id": {
            "type": "text",
            "value": "{{user_id.name}}"
          },
          "attack_count": {
            "type": "number",
            "value": "{{value}}"
          },
          "attack_type": {
            "type": "dropdown",
            "options": [
              "decompression_bomb",
              "invalid_image",
              "polyglot_file",
              "unknown"
            ],
            "value": "decompression_bomb"
          },
          "root_cause": {
            "type": "text",
            "value": "Image-based attack detected from user {{user_id.name}}"
          },
          "customer_impact": {
            "type": "text",
            "value": "Try-On service blocked attacks, minimal customer impact"
          },
          "services_affected": {
            "type": "multiselect",
            "value": [
              "tryonservice"
            ]
          }
        },
        "runbook_link": "https://github.com/mvp-ing/v-commerce-studio/blob/main/docs/RUNBOOKS.md#multimodal-security-attack-detection"
      }
    }
  ],
  "severity_definitions": {
    "SEV-1": {
      "name": "Critical",
      "description": "Security or revenue impact requiring immediate response",
      "response_time": "5 minutes",
      "examples": [
        "Prompt injection detected",
        "Active security attack",
        "Data exposure risk"
      ]
    },
    "SEV-2": {
      "name": "High",
      "description": "Significant user or security impact requiring prompt response",
      "response_time": "15 minutes",
      "examples": [
        "Multimodal attack detected",
        "High error rate",
        "Service degradation"
      ]
    }
  },
  "on_call_teams": {
    "security-oncall": {
      "name": "Security Team",
      "slack_channel": "#security-alerts",
      "pagerduty_service": "security-oncall",
      "responsibilities": [
        "Prompt injection detection",
        "Multimodal security attacks",
        "Data protection",
        "Security incidents"
      ]
    }
  },
  "incident_templates": [
    {
      "name": "Prompt Injection Security Incident",
      "fields": [
        {
          "name": "Attacker Session ID",
          "type": "text",
          "required": true,
          "description": "Session ID of the attacker"
        },
        {
          "name": "Injection Score",
          "type": "number",
          "required": true,
          "description": "Score indicating confidence of injection attempt (0-1)"
        },
        {
          "name": "Attack Vector",
          "type": "dropdown",
          "options": [
            "prompt_injection",
            "jailbreak",
            "system_prompt_extraction",
            "data_exfiltration",
            "unknown"
          ],
          "required": true
        },
        {
          "name": "Session Blocked",
          "type": "boolean",
          "required": false
        }
      ]
    },
    {
      "name": "Multimodal Security Incident",
      "fields": [
        {
          "name": "Attacker User ID",
          "type": "text",
          "required": true,
          "description": "User ID of the attacker"
        },
        {
          "name": "Attack Count",
          "type": "number",
          "required": true,
          "description": "Number of attack attempts in 5 minute window"
        },
        {
          "name": "Attack Type",
          "type": "dropdown",
          "options": [
            "decompression_bomb",
            "invalid_image",
            "polyglot_file",
            "memory_exhaustion",
            "unknown"
          ],
          "required": true
        },
        {
          "name": "User Blocked",
          "type": "boolean",
          "required": false
        }
      ]
    }
  ],
  "dashboard_links": {
    "llm_observability": "/dashboard/llm-observability",
    "security_overview": "/dashboard/security-overview"
  },
  "runbooks": {
    "prompt_injection": "https://github.com/mvp-ing/v-commerce-studio/blob/main/docs/RUNBOOKS.md#2-prompt-injection-detection-runbook",
    "multimodal_attack": "https://github.com/mvp-ing/v-commerce-studio/blob/main/docs/RUNBOOKS.md#6-multimodal-security-attack-runbook"
  }
}